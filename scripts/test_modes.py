#!/usr/bin/env python3
"""
test_modes.py
–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö —Ä–µ–∂–∏–º–æ–≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
"""

import os
import asyncio
import subprocess
import sys

def test_mode(mode):
    """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"""
    print(f"\n{'='*50}")
    print(f"üß™ –¢–µ—Å—Ç–∏—Ä—É—é —Ä–µ–∂–∏–º: {mode}")
    print(f"{'='*50}")
    
    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è
    env = os.environ.copy()
    env["MONITOR_MODE"] = mode
    env["CHECK_INTERVAL"] = "1"  # –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è —Ç–µ—Å—Ç–∞
    
    try:
        # –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏
        result = subprocess.run(
            [sys.executable, "../src/bot_liner_monitor.py"],
            env=env,
            timeout=30,  # –ú–∞–∫—Å–∏–º—É–º 30 —Å–µ–∫—É–Ω–¥ –Ω–∞ —Ç–µ—Å—Ç
            capture_output=True,
            text=True
        )
        
        print("üì§ –í—ã–≤–æ–¥:")
        print(result.stdout)
        
        if result.stderr:
            print("‚ùå –û—à–∏–±–∫–∏:")
            print(result.stderr)
            
    except subprocess.TimeoutExpired:
        print("‚è∞ –¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω –ø–æ —Ç–∞–π–º–∞—É—Ç—É (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ)")
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏: {e}")

def main():
    print("üß™ –ó–∞–ø—É—Å–∫–∞—é —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞...")
    
    # –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä–µ–∂–∏–º "–≤—Å–µ –∫–≤–∞—Ä—Ç–∏—Ä—ã"
    test_mode("all")
    
    # –ù–µ–±–æ–ª—å—à–∞—è –ø–∞—É–∑–∞ –º–µ–∂–¥—É —Ç–µ—Å—Ç–∞–º–∏
    import time
    time.sleep(2)
    
    # –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä–µ–∂–∏–º "—Ç–æ–ª—å–∫–æ –ñ–ö –õ–∞–π–Ω–µ—Ä"
    test_mode("liner")
    
    print(f"\n{'='*50}")
    print("‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    print("–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—ã–≤–æ–¥ –≤—ã—à–µ, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –∫–∞–∫–æ–π —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç–∞–µ—Ç –ª—É—á—à–µ.")

if __name__ == "__main__":
    main()
